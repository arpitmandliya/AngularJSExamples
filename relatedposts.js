function relatedPostsWidget(e){!function(t){var a={blogURL:"",maxPosts:5,maxTags:5,maxPostsPerTag:5,containerSelector:"",tags:null,loadingText:"",loadingClass:"",relevantTip:"",relatedTitle:"Related Posts",recentTitle:"Recent Posts",postScoreClass:"",onLoad:!1};a=t.extend({},a,e);var r=0,s=null,l=null;a.containerSelector||(document.write('<div id="related-posts"></div>'),a.containerSelector="#related-posts");var n=function(e,n){if(r++,e.feed.entry)for(var i=0;i<e.feed.entry.length;i++){for(var d=e.feed.entry[i],c="",g=0;g<d.link.length;g++)if("alternate"==d.link[g].rel){c=d.link[g].href;break}var p=d.title.$t;location.href.toLowerCase()!=c.toLowerCase()&&o(c,p)}r>=a.tags.length&&(l.attr("class",""),t("#related-posts-loadingtext",s).remove(),a.maxPosts>0&&t("li:gt("+(a.maxPosts-1)+")",l).remove())},o=function(e,r){for(var s=t("li",l),n=0;n<s.length;n++){var o=t("a",s.eq(n)),c=i(o);if(o.attr("href")==e){d(o,++c);for(var g=n-1;g>=0;g--){var p=t("a",s.eq(g));if(i(p)>c)return void(n-g>1&&s.eq(g).after(s.eq(n)))}return void(n>0&&s.eq(0).before(s.eq(n)))}}l.append('<li><a href="'+e+'" title="'+(a.relevantTip?a.relevantTip.replace("d",1):"")+'">'+r+"</a></li>")},i=function(e){var t=parseInt(e.attr("score"));return t>0?t:1},d=function(e,t){e.attr("score",t),a.relevantTip&&e.attr("title",a.relevantTip.replace("d",t)),a.postScoreClass&&e.attr("class",a.postScoreClass+t)},c=function(){if("#related-posts"!=a.containerSelector){var e=t(a.containerSelector);if(1!=e.length)return;s=t('<div id="related-posts"></div>').appendTo(e)}else s=t(a.containerSelector);if(a.tags||(a.tags=[],t('a[rel="tag"]:lt('+a.maxTags+")").each(function(){var e=t.trim(t(this).text().replace(/\n/g,""));-1==t.inArray(e,a.tags)&&(a.tags[a.tags.length]=e)})),0!=a.tags.length||a.recentTitle)if(0==a.tags.length?t("<h2>"+a.recentTitle+"</h2>").appendTo(s):a.relatedTitle&&t("<h2>"+a.relatedTitle+"</h2>").appendTo(s),a.loadingText&&t('<div id="related-posts-loadingtext">'+a.loadingText+"</div>").appendTo(s),l=t("<ul "+(a.loadingClass?'class="'+a.loadingClass+'"':"")+"></ul>").appendTo(s),0==a.tags.length)t.ajax({url:a.blogURL+"/feeds/posts/summary/",data:{"max-results":a.maxPostsPerTag,alt:"json-in-script"},success:n,dataType:"jsonp",cache:!0});else for(var r=0;r<a.tags.length;r++)t.ajax({url:a.blogURL+"/feeds/posts/summary/",data:{category:a.tags[r],"max-results":a.maxPostsPerTag,alt:"json-in-script"},success:n,dataType:"jsonp",cache:!0})};a.onLoad?t(window).load(c):t(document).ready(c)}(jQuery)}
